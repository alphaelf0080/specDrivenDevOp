# æ¨¹ç‹€åœ–è¦–åœ–ç‹€æ…‹æŒä¹…åŒ– - å¿«é€Ÿåƒè€ƒ

## ğŸ¯ åŠŸèƒ½éœ€æ±‚å¯¦ç¾ç‹€æ…‹

âœ… **"æ¨¹ç‹€åœ– pan ç§»å‹• èˆ‡ zoom in/out è¦èƒ½ç´€éŒ„ï¼Œä¸‹æ¬¡è¼‰å…¥æ™‚ï¼Œè¦èƒ½ç›¸åŒ"**

## ğŸ“‹ åŠŸèƒ½æ‘˜è¦

| åŠŸèƒ½ | èªªæ˜ | å¯¦ç¾ç‹€æ…‹ |
|------|------|----------|
| Pan ç§»å‹•è¨˜éŒ„ | æ»‘é¼ æ‹–æ›³ç§»å‹•ä½ç½®è‡ªå‹•ä¿å­˜ | âœ… å®Œæˆ |
| Zoom ç¸®æ”¾è¨˜éŒ„ | æ»‘é¼ æ»¾è¼ªç¸®æ”¾å€æ•¸è‡ªå‹•ä¿å­˜ | âœ… å®Œæˆ |
| ç‹€æ…‹æ¢å¾© | ä¸‹æ¬¡è¼‰å…¥æ™‚è‡ªå‹•æ¢å¾©è¦–åœ–ç‹€æ…‹ | âœ… å®Œæˆ |
| å¤šæ¨¹ç‹€åœ–æ”¯æ´ | ä¸åŒæ¨¹ç‹€åœ–ç¨ç«‹ä¿å­˜è¦–åœ–ç‹€æ…‹ | âœ… å®Œæˆ |
| é¦–æ¬¡è¨ªå•å„ªåŒ– | æ–°æ¨¹ç‹€åœ–è‡ªå‹• fitView æœ€ä½³è¦–åœ– | âœ… å®Œæˆ |

## ğŸ”§ æŠ€è¡“å¯¦ç¾

### æ ¸å¿ƒçµ„ä»¶
- **æª”æ¡ˆ**ï¼š`client/components/Tree/TreeDiagram.tsx`
- **å­˜å„²æ–¹å¼**ï¼šlocalStorage (æŒ‰æ¨¹ç‹€åœ– ID åˆ†åˆ¥å­˜å„²)
- **æª¢æ¸¬æ©Ÿåˆ¶**ï¼šReact Flow `onMove` äº‹ä»¶é©…å‹•
- **API æ•´åˆ**ï¼šReact Flow Viewport API + onMove handler

### å­˜å„²çµæ§‹
```javascript
localStorage['tree-viewport-{treeId}'] = {
  "x": -123.45,    // Pan X è»¸ä½ç§»
  "y": 67.89,      // Pan Y è»¸ä½ç§»  
  "zoom": 1.25     // ç¸®æ”¾å€æ•¸
}
```

## ğŸš€ ç”¨æˆ¶é«”é©—

### ä½¿ç”¨æµç¨‹
1. **é¦–æ¬¡è¨ªå•**ï¼šè‡ªå‹•åŸ·è¡Œ `fitView()` æœ€ä½³åŒ–è¦–åœ–
2. **æ“ä½œè¦–åœ–**ï¼šæ‹–æ›³ç§»å‹•ã€æ»¾è¼ªç¸®æ”¾ï¼Œç³»çµ±è‡ªå‹•ä¿å­˜
3. **é‡æ–°è¼‰å…¥**ï¼šè‡ªå‹•æ¢å¾©ä¸Šæ¬¡çš„è¦–åœ–ç‹€æ…‹

### æ™ºèƒ½è¡Œç‚º
- âœ… ä½¿ç”¨ `onMove` äº‹ä»¶å³æ™‚æ•æ‰è¦–åœ–è®ŠåŒ–
- âœ… é¦–æ¬¡è¨ªå•èˆ‡ç‹€æ…‹æ¢å¾©çš„æ™ºèƒ½åˆ¤æ–·
- âœ… å®¹éŒ¯è™•ç†ï¼ŒlocalStorage ç•°å¸¸æ™‚å„ªé›…é™ç´š
- âœ… 500ms ç¯€æµæ©Ÿåˆ¶é¿å…éåº¦é »ç¹çš„å­˜å„²æ“ä½œ
- âœ… 100ms åˆå§‹åŒ–å»¶é²ç¢ºä¿ React Flow å®Œå…¨å°±ç·’

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¿«é€Ÿé‡ç½®
```javascript
// æ¸…é™¤ç‰¹å®šæ¨¹ç‹€åœ–è¦–åœ–ç‹€æ…‹
localStorage.removeItem('tree-viewport-{treeId}');

// æ¸…é™¤æ‰€æœ‰æ¨¹ç‹€åœ–è¦–åœ–ç‹€æ…‹
Object.keys(localStorage)
  .filter(key => key.startsWith('tree-viewport-'))
  .forEach(key => localStorage.removeItem(key));
```

### é™¤éŒ¯æª¢æŸ¥
```javascript
// æŸ¥çœ‹ç•¶å‰ä¿å­˜çš„è¦–åœ–ç‹€æ…‹
console.log(localStorage.getItem('tree-viewport-{treeId}'));
```

## ğŸ“š ç›¸é—œæ–‡æª”

- **è©³ç´°æŠ€è¡“æ–‡æª”**ï¼š[tree-viewport-persistence.md](./tree-viewport-persistence.md)
- **ç³»çµ±æ¦‚è¦½**ï¼š[tree-system-overview.md](./tree-system-overview.md)
- **æ›´æ–°ç´€éŒ„**ï¼š[CHANGELOG.md](../CHANGELOG.md)

## âš¡ æ€§èƒ½è¦æ ¼

- **æª¢æ¸¬æ©Ÿåˆ¶**ï¼šReact Flow `onMove` äº‹ä»¶ï¼ˆå³æ™‚ï¼‰
- **ç¯€æµå»¶é²**ï¼š500ms
- **åˆå§‹åŒ–å»¶é²**ï¼š100ms
- **å„²å­˜å¤§å°**ï¼š~50 bytes æ¯å€‹æ¨¹ç‹€åœ–
- **è¨˜æ†¶é«”é–‹éŠ·**ï¼šæœ€å°åŒ–ï¼Œä½¿ç”¨åŸç”Ÿ localStorage
- **ç›¸å®¹æ€§**ï¼šæ”¯æ´æ‰€æœ‰ç¾ä»£ç€è¦½å™¨